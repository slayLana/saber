{"remainingRequest":"/Users/jiang/WorkSpace/bladex/saber/node_modules/babel-loader/lib/index.js!/Users/jiang/WorkSpace/bladex/saber/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/jiang/WorkSpace/bladex/saber/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jiang/WorkSpace/bladex/saber/src/views/warehousingEntry/warehousingEntry.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jiang/WorkSpace/bladex/saber/src/views/warehousingEntry/warehousingEntry.vue","mtime":1668865005787},{"path":"/Users/jiang/WorkSpace/bladex/saber/babel.config.js","mtime":1666151205448},{"path":"/Users/jiang/WorkSpace/bladex/saber/node_modules/cache-loader/dist/cjs.js","mtime":1666157453018},{"path":"/Users/jiang/WorkSpace/bladex/saber/node_modules/babel-loader/lib/index.js","mtime":1666157453268},{"path":"/Users/jiang/WorkSpace/bladex/saber/node_modules/cache-loader/dist/cjs.js","mtime":1666157453018},{"path":"/Users/jiang/WorkSpace/bladex/saber/node_modules/vue-loader/lib/index.js","mtime":1666157454301}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.regexp.search\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _defineProperty from \"/Users/jiang/WorkSpace/bladex/saber/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport { getList, getDetail, getGoodsInfo as _getGoodsInfo, add, update, remove } from \"@/api/warehousingEntry/warehousingEntry\";\nimport option from \"@/const/warehousingEntry/warehousingEntry\";\nimport { mapGetters } from \"vuex\";\nimport store from \"../../store\";\nimport { exportBlob } from \"@/api/common\";\nimport { getToken } from \"@/util/auth\";\nimport NProgress from 'nprogress';\nimport 'nprogress/nprogress.css';\nimport { downloadXls, timeFormate } from \"@/util/util\";\nexport default {\n  data: function data() {\n    return {\n      fullscreenLoading: false,\n      headers: {\n        \"Blade-Auth\": \"Bearer \" + store.getters.token\n      },\n      // 弹框标题\n      title: \"\",\n      // 是否展示弹框\n      box: false,\n      // 是否显示查询\n      search: true,\n      // 加载中\n      loading: true,\n      // 是否为查看模式\n      view: false,\n      // 查询信息\n      query: {},\n      // 分页信息\n      page: {\n        currentPage: 1,\n        pageSize: 10,\n        total: 40\n      },\n      // 表单数据\n      form: {},\n      // 选择行\n      selectionList: [],\n      // 表单配置\n      option: option,\n      // 表单列表\n      data: []\n    };\n  },\n  mounted: function mounted() {\n    this.init();\n    this.onLoad(this.page);\n  },\n  watch: {\n    totalPrice: function totalPrice() {\n      this.form.totalPrice = this.totalPrice;\n    }\n  },\n  computed: _objectSpread(_objectSpread({}, mapGetters([\"permission\"])), {}, {\n    ids: function ids() {\n      var ids = [];\n      this.selectionList.forEach(function (ele) {\n        ids.push(ele.id);\n      });\n      return ids.join(\",\");\n    },\n    totalPrice: function totalPrice() {\n      return (this.form.goodsNumber * this.form.goodsPrice).toFixed(2) || 0;\n    }\n  }),\n  methods: {\n    init: function init() {},\n    searchHide: function searchHide() {\n      this.search = !this.search;\n    },\n    getGoodsInfo: function getGoodsInfo(id) {\n      var _this = this;\n\n      if (id.length == 6) {\n        _getGoodsInfo(id).then(function (res) {\n          var tmp = {\n            business: res.data.data.business,\n            goodsCode: res.data.data.goodsCode,\n            goodsName: res.data.data.goodsName,\n            goodsColor: res.data.data.goodsColor,\n            goodsWeightK: res.data.data.goodsWeightK\n          };\n          _this.form = _objectSpread(_objectSpread({}, _this.form), tmp);\n        });\n      }\n    },\n    clickMenu: function clickMenu(f) {\n      f();\n    },\n    exportInTemp: function exportInTemp() {\n      exportBlob(\"/api/blade-warehousingEntry/warehousingEntry/export-temp?op=1&\".concat(this.website.tokenHeader, \"=\").concat(getToken()), 1).then(function (res) {\n        downloadXls(res.data, \"\\u5165\\u5E93\\u5355\\u6A21\\u677F.xlsx\");\n      });\n    },\n    exportOutTemp: function exportOutTemp() {\n      exportBlob(\"/api/blade-warehousingEntry/warehousingEntry/export-temp?op=0&\".concat(this.website.tokenHeader, \"=\").concat(getToken()), 0).then(function (res) {\n        downloadXls(res.data, \"\\u51FA\\u5E93\\u5355\\u6A21\\u677F.xlsx\");\n      });\n    },\n    handleExport: function handleExport() {\n      var _this2 = this;\n\n      this.$confirm(\"是否导出入库单数据?\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(function () {\n        NProgress.start();\n        exportBlob(\"/api/blade-warehousingEntry/warehousingEntry/export-data?\".concat(_this2.website.tokenHeader, \"=\").concat(getToken()), _this2.query).then(function (res) {\n          downloadXls(res.data, \"\\u5165\\u5E93\\u5355\".concat(timeFormate(new Date()), \".xlsx\"));\n          NProgress.done();\n        });\n      });\n    },\n    searchChange: function searchChange() {\n      this.onLoad(this.page);\n    },\n    searchReset: function searchReset() {\n      this.query = {};\n      this.page.currentPage = 1;\n      this.onLoad(this.page);\n    },\n    handleSubmit: function handleSubmit() {\n      var _this3 = this;\n\n      if (!this.form.id) {\n        add(this.form).then(function () {\n          _this3.box = false;\n\n          _this3.onLoad(_this3.page);\n\n          _this3.$message({\n            type: \"success\",\n            message: \"操作成功!\"\n          });\n        });\n      } else {\n        update(this.form).then(function () {\n          _this3.box = false;\n\n          _this3.onLoad(_this3.page);\n\n          _this3.$message({\n            type: \"success\",\n            message: \"操作成功!\"\n          });\n        });\n      }\n    },\n    handleAdd: function handleAdd() {\n      this.title = \"新增\";\n      this.form = {};\n      this.box = true;\n    },\n    handleEdit: function handleEdit(row) {\n      var _this4 = this;\n\n      this.title = \"编辑\";\n      this.box = true;\n      getDetail(row.id).then(function (res) {\n        _this4.form = res.data.data;\n      });\n    },\n    handleView: function handleView(row) {\n      var _this5 = this;\n\n      this.title = \"查看\";\n      this.view = true;\n      this.box = true;\n      getDetail(row.id).then(function (res) {\n        _this5.form = res.data.data;\n      });\n    },\n    handleDelete: function handleDelete() {\n      var _this6 = this;\n\n      if (this.selectionList.length === 0) {\n        this.$message.warning(\"请选择至少一条数据\");\n        return;\n      }\n\n      this.$confirm(\"确定将选择数据删除?\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(function () {\n        return remove(_this6.ids);\n      }).then(function () {\n        _this6.selectionClear();\n\n        _this6.onLoad(_this6.page);\n\n        _this6.$message({\n          type: \"success\",\n          message: \"操作成功!\"\n        });\n      });\n    },\n    rowDel: function rowDel(row) {\n      var _this7 = this;\n\n      this.$confirm(\"确定将选择数据删除?\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(function () {\n        return remove(row.id);\n      }).then(function () {\n        _this7.onLoad(_this7.page);\n\n        _this7.$message({\n          type: \"success\",\n          message: \"操作成功!\"\n        });\n      });\n    },\n    beforeClose: function beforeClose(done) {\n      done();\n      this.form = {};\n      this.view = false;\n    },\n    selectionChange: function selectionChange(list) {\n      this.selectionList = list;\n    },\n    selectionClear: function selectionClear() {\n      this.selectionList = [];\n      this.$refs.table.clearSelection();\n    },\n    currentChange: function currentChange(currentPage) {\n      this.page.currentPage = currentPage;\n      this.onLoad(this.page);\n    },\n    sizeChange: function sizeChange(pageSize) {\n      this.page.pageSize = pageSize;\n      this.onLoad(this.page);\n    },\n    onLoad: function onLoad(page) {\n      var _this8 = this;\n\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      this.loading = true;\n      getList(page.currentPage, page.pageSize, Object.assign(params, this.query)).then(function (res) {\n        var data = res.data.data;\n        _this8.page.total = data.total;\n        _this8.data = data.records;\n        _this8.loading = false;\n\n        _this8.selectionClear();\n      });\n    },\n    handleSuccess: function handleSuccess(res) {\n      this.$refs.upload1.clearFiles();\n      this.$refs.upload2.clearFiles();\n      this.$message({\n        message: res.msg,\n        type: \"success\"\n      });\n      this.fullscreenLoading = false;\n      this.onLoad(this.page);\n    },\n    hadleUpload: function hadleUpload() {\n      this.fullscreenLoading = true;\n    }\n  }\n};",{"version":3,"mappings":"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","names":["getList","getDetail","getGoodsInfo","add","update","remove","data","fullscreenLoading","headers","title","box","search","loading","view","query","page","currentPage","pageSize","total","form","selectionList","option","mounted","watch","totalPrice","computed","mapGetters","ids","methods","init","searchHide","id","business","goodsCode","goodsName","goodsColor","goodsWeightK","clickMenu","f","exportInTemp","exportBlob","downloadXls","exportOutTemp","handleExport","confirmButtonText","cancelButtonText","type","then","NProgress","searchChange","searchReset","handleSubmit","message","handleAdd","handleEdit","row","handleView","handleDelete","rowDel","beforeClose","done","selectionChange","list","selectionClear","currentChange","sizeChange","onLoad","Object","handleSuccess","res","hadleUpload"],"sourceRoot":"src/views/warehousingEntry","sources":["warehousingEntry.vue"],"sourcesContent":["<template>\n  <basic-container v-loading=\"fullscreenLoading\">\n    <div class=\"avue-crud\">\n      <el-row :hidden=\"!search\" style=\"padding: 5px\">\n        <!-- 查询模块 -->\n        <el-form :inline=\"true\" :size=\"option.size\" :model=\"query\">\n          <template>\n            <el-form-item label=\"货品ID\">\n              <el-input v-model=\"query.skuId\" placeholder=\"请输入货品ID\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"产商\">\n              <el-input v-model=\"query.business\" placeholder=\"请输入产商\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"商品\">\n              <el-input v-model=\"query.goodsName\" placeholder=\"请输入商品名称\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"颜色规格\">\n              <el-input v-model=\"query.goodsName\" placeholder=\"请输入颜色规格\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"操作状态\">\n              <el-select\n              v-model=\"query.operate\"\n                clearable\n                multiple\n                placeholder=\"请选择\"\n              >\n              <el-option\n                  :key=\"1\"\n                  label=\"入库\"\n                  :value=\"1\"\n                >\n                </el-option>\n                <el-option\n                  :key=\"0\"\n                  label=\"出库\"\n                  :value=\"0\"\n                >\n                </el-option>\n              </el-select>\n            </el-form-item>\n            <el-form-item label=\"下单日期\">\n              <el-date-picker\n              type=\"daterange\"\n              format=\"yyyy-MM-dd\"\n              value-format=\"yyyy-MM-dd\"\n      v-model=\"query.orderDateRange\"\n      placeholder=\"选择日期\">\n    </el-date-picker>\n            </el-form-item>\n          </template>\n          <!-- 查询按钮 -->\n          <el-form-item>\n            <el-button\n              type=\"primary\"\n              icon=\"el-icon-search\"\n              @click=\"searchChange\"\n              >搜索</el-button\n            >\n            <el-button icon=\"el-icon-delete\" @click=\"searchReset()\"\n              >清空</el-button\n            >\n          </el-form-item>\n        </el-form>\n      </el-row>\n      <el-row>\n        <div class=\"avue-crud__menu\">\n          <!-- 头部左侧按钮模块 -->\n          <div class=\"avue-crud__left\">\n            <el-button\n              :size=\"option.size\"\n              type=\"primary\"\n              icon=\"el-icon-plus\"\n              @click=\"handleAdd\"\n              >新增</el-button\n            >\n            <el-button\n              :size=\"option.size\"\n              type=\"danger\"\n              icon=\"el-icon-delete\"\n              @click=\"handleDelete\"\n              plain\n              >删除\n            </el-button>\n             <el-dropdown >\n  <el-button type=\"primary\" :size=\"option.size\">\n    导入<i class=\"el-icon-arrow-down el-icon--right\"></i>\n  </el-button>\n  <el-dropdown-menu slot=\"dropdown\" >\n    <el-dropdown-item ><el-upload\n              class=\"upload\"\n              :headers=\"headers\"\n              action=\"/api/blade-warehousingEntry/warehousingEntry/import-excel?operate=1\"\n              multiple\n              ref=\"upload1\"\n              :show-file-list=\"false\"\n              :limit=\"1\"\n              :on-success=\"handleSuccess\"\n              :before-upload=\"hadleUpload\"\n            >\n              入库单\n            </el-upload></el-dropdown-item>\n            <el-dropdown-item >\n            <el-upload\n              class=\"upload\"\n              :headers=\"headers\"\n              action=\"/api/blade-warehousingEntry/warehousingEntry/import-excel?operate=0\"\n              multiple\n              ref=\"upload2\"\n              :show-file-list=\"false\"\n              :limit=\"1\"\n              :on-success=\"handleSuccess\"\n              :before-upload=\"hadleUpload\"\n            >出库单\n            </el-upload></el-dropdown-item>\n  </el-dropdown-menu>\n</el-dropdown>\n            <!-- <el-upload\n              class=\"upload\"\n              :headers=\"headers\"\n              action=\"/api/blade-warehousingEntry/warehousingEntry/import-excel?operate=1\"\n              multiple\n              ref=\"upload\"\n              :show-file-list=\"false\"\n              :limit=\"1\"\n              :on-success=\"handleSuccess\"\n              :before-upload=\"hadleUpload\"\n            >\n              <el-button :size=\"option.size\" type=\"primary\" \n                >导入入库单</el-button\n              >\n            </el-upload> -->\n            <el-dropdown @command=\"clickMenu\">\n  <el-button type=\"primary\" :size=\"option.size\">\n    导出<i class=\"el-icon-arrow-down el-icon--right\"></i>\n  </el-button>\n  <el-dropdown-menu slot=\"dropdown\" >\n    <el-dropdown-item :command=\"handleExport\">入库单数据</el-dropdown-item>\n    <el-dropdown-item :command=\"exportInTemp\">入库单模板</el-dropdown-item>\n    <el-dropdown-item :command=\"exportOutTemp\">出库单模板</el-dropdown-item>\n  </el-dropdown-menu>\n</el-dropdown>\n          </div>\n          <!-- 头部右侧按钮模块 -->\n          <div class=\"avue-crud__right\">\n            <el-button\n              :size=\"option.size\"\n              icon=\"el-icon-refresh\"\n              @click=\"searchChange\"\n              circle\n            ></el-button>\n            <el-button\n              :size=\"option.size\"\n              icon=\"el-icon-search\"\n              @click=\"searchHide\"\n              circle\n            ></el-button>\n          </div>\n        </div>\n      </el-row>\n      <el-row>\n        <!-- 列表模块 -->\n        <el-table\n          ref=\"table\"\n          v-loading=\"loading\"\n          :size=\"option.size\"\n          @selection-change=\"selectionChange\"\n          :data=\"data\"\n          style=\"width: 100%\"\n          :border=\"option.border\"\n        >\n          <el-table-column\n            type=\"selection\"\n            v-if=\"option.selection\"\n            width=\"55\"\n            align=\"center\"\n          ></el-table-column>\n          <el-table-column\n            type=\"expand\"\n            v-if=\"option.expand\"\n            align=\"center\"\n          ></el-table-column>\n          <template v-for=\"(item, index) in option.column\">\n            <!-- table字段 -->\n            <el-table-column\n              v-if=\"item.hide !== true\"\n              :prop=\"item.prop\"\n              :label=\"item.label\"\n              :width=\"item.width\"\n              :showOverflowTooltip=\"item.showOverflowTooltip\"\n              :key=\"index\"\n            >\n              <template slot-scope=\"{ row }\">\n                <template v-if=\"item.prop == 'operate'\">\n                  <el-tag type=\"success\" v-if=\"row.operate == 1\">入库</el-tag>\n                  <el-tag type=\"warning\" v-if=\"row.operate == 0\">出库</el-tag>\n                </template>\n                <template v-else>{{ row[item.prop] }}</template>\n              </template>\n            </el-table-column>\n          </template>\n          <!-- 操作栏模块 -->\n          <el-table-column prop=\"menu\" label=\"操作\" :width=\"180\" align=\"center\">\n            <template slot-scope=\"{ row }\">\n              <el-button\n                :size=\"option.size\"\n                type=\"text\"\n                icon=\"el-icon-edit\"\n                @click=\"handleEdit(row)\"\n                >编辑</el-button\n              >\n              <el-button\n                :size=\"option.size\"\n                type=\"text\"\n                icon=\"el-icon-delete\"\n                @click=\"rowDel(row)\"\n                >删除</el-button\n              >\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-row>\n      <el-row>\n        <!-- 分页模块 -->\n        <el-pagination\n          align=\"right\"\n          background\n          @size-change=\"sizeChange\"\n          @current-change=\"currentChange\"\n          :current-page=\"page.currentPage\"\n          :page-sizes=\"[10, 20, 30, 40, 50, 100]\"\n          :page-size=\"page.pageSize\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"page.total\"\n        >\n        </el-pagination>\n      </el-row>\n      <!-- 表单模块 -->\n      <el-dialog\n        :title=\"title\"\n        :visible.sync=\"box\"\n        width=\"50%\"\n        :before-close=\"beforeClose\"\n        append-to-body\n      >\n        <el-form\n          :disabled=\"view\"\n          :size=\"option.size\"\n          ref=\"form\"\n          :model=\"form\"\n          label-width=\"80px\"\n        >\n          <!-- 表单字段 -->\n          <el-form-item label=\"下单日期\" prop=\"orderDate\">\n            <!-- <el-input v-model=\"form.orderDate\" placeholder=\"请输入提报日期\" /> -->\n            <el-date-picker\n      v-model=\"form.orderDate\"\n      format=\"yyyy-MM-dd\"\n      value-format=\"yyyy-MM-dd\"\n      type=\"date\"\n\n      placeholder=\"选择日期\">\n    </el-date-picker>\n          </el-form-item>\n          <el-form-item label=\"货品Id\" prop=\"skuId\">\n            <el-input v-model=\"form.skuId\" placeholder=\"请输入货品Id\" @change=\"getGoodsInfo\"/>\n          </el-form-item>\n          <el-form-item label=\"产商\" prop=\"business\">\n            <el-input v-model=\"form.business\" placeholder=\"请输入产商\" disabled/>\n          </el-form-item>\n          <el-form-item label=\"货品条码\" prop=\"goodsCode\">\n            <el-input v-model=\"form.goodsCode\" placeholder=\"请输入条码\" disabled/>\n          </el-form-item>\n          <el-form-item label=\"商品名称\" prop=\"goodsName\">\n            <el-input v-model=\"form.goodsName\" placeholder=\"请输入商品名称\" disabled/>\n          </el-form-item>\n          <el-form-item label=\"颜色规格\" prop=\"goodsColor\">\n            <el-input v-model=\"form.goodsColor\" placeholder=\"请输入颜色规格\" disabled/>\n          </el-form-item>\n          <el-form-item label=\"克重\" prop=\"goodsWeightK\">\n            <el-input v-model=\"form.goodsWeightK\" placeholder=\"请输入克重\" disabled/>\n          </el-form-item>\n          <el-form-item label=\"单位\" prop=\"unit\">\n            <el-input v-model=\"form.unit\" placeholder=\"请输入单位\" />\n          </el-form-item>\n          <el-form-item label=\"单价\" prop=\"goodsPrice\">\n            <el-input v-model=\"form.goodsPrice\" placeholder=\"请输入单价\" />\n          </el-form-item>\n          <el-form-item label=\"补货量\" prop=\"goodsNumber\">\n            <el-input v-model=\"form.goodsNumber\" placeholder=\"请输入补货量\" />\n          </el-form-item>\n          <el-form-item label=\"总价\" prop=\"totalPrice\">\n            <el-input v-model=\"form.totalPrice\" placeholder=\"请输入总价\" disabled/>\n          </el-form-item>\n          <el-form-item label=\"到货/出货时间\" prop=\"arrivalDate\">\n            <!-- <el-input v-model=\"form.arrivalDate\" placeholder=\"预计到货时间\" /> -->\n            <el-date-picker\n      v-model=\"form.arrivalDate\"\n      format=\"yyyy-MM-dd\"\n      value-format=\"yyyy-MM-dd\"\n      type=\"date\"\n\n      placeholder=\"选择日期\"></el-date-picker>\n          </el-form-item>\n          <el-form-item label=\"操作\" prop=\"remark\">\n            <!-- <el-input v-model=\"form.remark\" placeholder=\"请输入备注\" /> -->\n                <el-radio-group v-model=\"form.operate\" >\n                  <el-radio :label=\"1\" >入库</el-radio>\n                  <el-radio :label=\"0\" >出库</el-radio>\n                </el-radio-group>\n          </el-form-item>\n          <el-form-item label=\"备注\" prop=\"remark\">\n            <el-input v-model=\"form.remark\" placeholder=\"请输入备注\" />\n          </el-form-item>\n          \n        </el-form>\n        <!-- 表单按钮 -->\n        <span v-if=\"!view\" slot=\"footer\" class=\"dialog-footer\">\n          <el-button\n            type=\"primary\"\n            icon=\"el-icon-circle-check\"\n            :size=\"option.size\"\n            @click=\"handleSubmit\"\n            >提 交</el-button\n          >\n          <el-button\n            icon=\"el-icon-circle-close\"\n            :size=\"option.size\"\n            @click=\"box = false\"\n            >取 消</el-button\n          >\n        </span>\n      </el-dialog>\n    </div>\n  </basic-container>\n</template>\n\n<script>\nimport {\n  getList,\n  getDetail,\n  getGoodsInfo,\n  add,\n  update,\n  remove,\n} from \"@/api/warehousingEntry/warehousingEntry\";\nimport option from \"@/const/warehousingEntry/warehousingEntry\";\nimport { mapGetters } from \"vuex\";\nimport store from \"../../store\";\n  import {exportBlob} from \"@/api/common\";\n  import {getToken} from \"@/util/auth\";\n  import NProgress from 'nprogress';\n  import 'nprogress/nprogress.css';\n  import { downloadXls, timeFormate } from \"@/util/util\";\n\nexport default {\n  data() {\n    return {\n      fullscreenLoading: false,\n      headers: {\n        \"Blade-Auth\": \"Bearer \" + store.getters.token,\n      },\n      // 弹框标题\n      title: \"\",\n      // 是否展示弹框\n      box: false,\n      // 是否显示查询\n      search: true,\n      // 加载中\n      loading: true,\n      // 是否为查看模式\n      view: false,\n      // 查询信息\n      query: {},\n      // 分页信息\n      page: {\n        currentPage: 1,\n        pageSize: 10,\n        total: 40,\n      },\n      \n      // 表单数据\n      form: {},\n      // 选择行\n      selectionList: [],\n      // 表单配置\n      option: option,\n      // 表单列表\n      data: [],\n    };\n  },\n  mounted() {\n    this.init();\n    this.onLoad(this.page);\n  },\n  watch:{\n    totalPrice(){\n      this.form.totalPrice = this.totalPrice\n    }\n  },\n  computed: {\n    ...mapGetters([\"permission\"]),\n    ids() {\n      let ids = [];\n      this.selectionList.forEach((ele) => {\n        ids.push(ele.id);\n      });\n      return ids.join(\",\");\n    },\n    totalPrice(){\n      return (this.form.goodsNumber * this.form.goodsPrice).toFixed(2) || 0;\n    }\n  },\n  methods: {\n    init() {},\n    searchHide() {\n      this.search = !this.search;\n    },\n    getGoodsInfo(id){\n      if(id.length == 6){\n        getGoodsInfo(id).then( res =>{\n          const tmp = {\n            business:res.data.data.business,\n            goodsCode:res.data.data.goodsCode,\n            goodsName:res.data.data.goodsName,\n            goodsColor:res.data.data.goodsColor,\n            goodsWeightK:res.data.data.goodsWeightK\n          }\n          this.form = {...this.form,...tmp};\n        })\n      }\n    },\n    clickMenu(f){\n      f()\n    },\n    exportInTemp(){\n       exportBlob(`/api/blade-warehousingEntry/warehousingEntry/export-temp?op=1&${this.website.tokenHeader}=${getToken()}`,1).then(res => {\n             downloadXls(res.data, `入库单模板.xlsx`);\n          })\n    },\n    exportOutTemp(){\n       exportBlob(`/api/blade-warehousingEntry/warehousingEntry/export-temp?op=0&${this.website.tokenHeader}=${getToken()}`,0).then(res => {\n            downloadXls(res.data, `出库单模板.xlsx`)\n          })\n    },\n    handleExport() {\n        this.$confirm(\"是否导出入库单数据?\", \"提示\", {\n          confirmButtonText: \"确定\",\n          cancelButtonText: \"取消\",\n          type: \"warning\"\n        }).then(() => {\n          NProgress.start();\n          exportBlob(`/api/blade-warehousingEntry/warehousingEntry/export-data?${this.website.tokenHeader}=${getToken()}`,this.query).then(res => {\n            downloadXls(res.data, `入库单${timeFormate(new Date())}.xlsx`);\n            NProgress.done();\n          })\n        });\n      },\n    searchChange() {\n      this.onLoad(this.page);\n    },\n    searchReset() {\n      this.query = {};\n      this.page.currentPage = 1;\n      this.onLoad(this.page);\n    },\n    handleSubmit() {\n      if (!this.form.id) {\n        add(this.form).then(() => {\n          this.box = false;\n          this.onLoad(this.page);\n          this.$message({\n            type: \"success\",\n            message: \"操作成功!\",\n          });\n        });\n      } else {\n        update(this.form).then(() => {\n          this.box = false;\n          this.onLoad(this.page);\n          this.$message({\n            type: \"success\",\n            message: \"操作成功!\",\n          });\n        });\n      }\n    },\n    handleAdd() {\n      this.title = \"新增\";\n      this.form = {};\n      this.box = true;\n    },\n    handleEdit(row) {\n      this.title = \"编辑\";\n      this.box = true;\n      getDetail(row.id).then((res) => {\n        this.form = res.data.data;\n      });\n    },\n    handleView(row) {\n      this.title = \"查看\";\n      this.view = true;\n      this.box = true;\n      getDetail(row.id).then((res) => {\n        this.form = res.data.data;\n      });\n    },\n    handleDelete() {\n      if (this.selectionList.length === 0) {\n        this.$message.warning(\"请选择至少一条数据\");\n        return;\n      }\n      this.$confirm(\"确定将选择数据删除?\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\",\n      })\n        .then(() => {\n          return remove(this.ids);\n        })\n        .then(() => {\n          this.selectionClear();\n          this.onLoad(this.page);\n          this.$message({\n            type: \"success\",\n            message: \"操作成功!\",\n          });\n        });\n    },\n    rowDel(row) {\n      this.$confirm(\"确定将选择数据删除?\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\",\n      })\n        .then(() => {\n          return remove(row.id);\n        })\n        .then(() => {\n          this.onLoad(this.page);\n          this.$message({\n            type: \"success\",\n            message: \"操作成功!\",\n          });\n        });\n    },\n    beforeClose(done) {\n      done();\n      this.form = {};\n      this.view = false;\n    },\n    selectionChange(list) {\n      this.selectionList = list;\n    },\n    selectionClear() {\n      this.selectionList = [];\n      this.$refs.table.clearSelection();\n    },\n    currentChange(currentPage) {\n      this.page.currentPage = currentPage;\n      this.onLoad(this.page);\n    },\n    sizeChange(pageSize) {\n      this.page.pageSize = pageSize;\n      this.onLoad(this.page);\n    },\n    onLoad(page, params = {}) {\n      this.loading = true;\n      getList(\n        page.currentPage,\n        page.pageSize,\n        Object.assign(params, this.query)\n      ).then((res) => {\n        const data = res.data.data;\n        this.page.total = data.total;\n        this.data = data.records;\n        this.loading = false;\n        this.selectionClear();\n      });\n    },\n    handleSuccess(res) {\n      this.$refs.upload1.clearFiles();\n      this.$refs.upload2.clearFiles();\n      this.$message({\n        message: res.msg,\n        type: \"success\",\n      });\n      this.fullscreenLoading = false;\n      this.onLoad(this.page);\n    },\n    hadleUpload() {\n      this.fullscreenLoading = true;\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.el-pagination {\n  margin-top: 20px;\n}\n.upload {\n  display: inline-block;\n}\n</style>\n"]}]}