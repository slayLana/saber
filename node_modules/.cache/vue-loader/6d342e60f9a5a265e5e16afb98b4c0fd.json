{"remainingRequest":"/Users/jiang/WorkSpace/bladex/saber/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jiang/WorkSpace/bladex/saber/src/views/flow/deploy.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jiang/WorkSpace/bladex/saber/src/views/flow/deploy.vue","mtime":1666151205538},{"path":"/Users/jiang/WorkSpace/bladex/saber/node_modules/cache-loader/dist/cjs.js","mtime":1666157453018},{"path":"/Users/jiang/WorkSpace/bladex/saber/node_modules/babel-loader/lib/index.js","mtime":1666157453268},{"path":"/Users/jiang/WorkSpace/bladex/saber/node_modules/cache-loader/dist/cjs.js","mtime":1666157453018},{"path":"/Users/jiang/WorkSpace/bladex/saber/node_modules/vue-loader/lib/index.js","mtime":1666157454301}],"contextDependencies":[],"result":["\n  import {deployUpload} from \"@/api/flow/flow\";\n  import {flowCategory} from \"@/util/flow\";\n\n  export default {\n    data() {\n      return {\n        form: {\n          flowCategory: '',\n          tenantId: '',\n          flowFile: [],\n          file: {},\n        },\n        option: {\n          labelWidth: 120,\n          menuBtn: false,\n          column: [\n            {\n              label: '流程类型',\n              prop: 'flowCategory',\n              type: 'select',\n              dicUrl: `/api/blade-system/dict/dictionary?code=flow`,\n              props: {\n                label: \"dictValue\",\n                value: \"dictKey\"\n              },\n              row: true,\n              span: 12,\n              dataType: \"number\",\n              rules: [\n                {\n                  required: true,\n                  message: '请选择流程类型',\n                  trigger: 'blur'\n                }\n              ]\n            },\n            {\n              label: \"流程模式\",\n              prop: \"flowMode\",\n              type: \"radio\",\n              dicData: [\n                {\n                  label: \"通用流程\",\n                  value: 1\n                },\n                {\n                  label: \"定制流程\",\n                  value: 2\n                }\n              ],\n              value: 1,\n              row: true,\n              span: 12,\n              rules: [\n                {\n                  required: true,\n                  message: '请选择流程模式',\n                  trigger: 'blur'\n                }\n              ],\n            },\n            {\n              label: \"所属租户\",\n              prop: \"tenantId\",\n              type: \"tree\",\n              multiple: true,\n              dicUrl: \"/api/blade-system/tenant/select\",\n              props: {\n                label: \"tenantName\",\n                value: \"tenantId\"\n              },\n              display: false,\n              row: true,\n              span: 12,\n              rules: [\n                {\n                  required: true,\n                  message: '请选择所属租户',\n                  trigger: 'blur'\n                }\n              ],\n            },\n            {\n              label: '附件上传',\n              prop: 'flowFile',\n              type: 'upload',\n              loadText: '附件上传中，请稍等',\n              span: 24,\n              propsHttp: {\n                res: 'data'\n              },\n              tip: '请上传 bpmn20.xml 标准格式文件',\n              action: '/api/blade-flow/manager/check-upload'\n            },\n          ]\n        }\n      }\n    },\n    watch: {\n      'form.flowMode'() {\n        this.$refs.form.option.column.filter(item => {\n          if (item.prop === \"tenantId\") {\n            item.display = this.form.flowMode === 2;\n          }\n        });\n      }\n    },\n    methods: {\n      uploadBefore(file, done) {\n        this.$message.success('部署开始');\n        this.file = file;\n        done()\n      },\n      uploadAfter(res, done, loading) {\n        if (!this.form.flowCategory) {\n          this.$message.warning('清先选择流程类型');\n          loading()\n          return false;\n        }\n        if (this.form.flowMode === 2 && !this.form.tenantId) {\n          this.$message.warning('清先选择对应租户');\n          loading();\n          return false;\n        }\n        if (res.success) {\n          deployUpload(\n            flowCategory(this.form.flowCategory),\n            (this.form.tenantId) ? this.form.tenantId.join(\",\") : \"\",\n            [this.file]\n          ).then(res => {\n            const data = res.data;\n            if (data.success) {\n              done()\n            } else {\n              this.$message.error(data.msg);\n              loading()\n            }\n          })\n        } else {\n          this.$message.warning('请上传 bpmn20.xml 标准格式文件');\n          loading()\n          return false;\n        }\n      },\n    }\n  }\n",{"version":3,"sources":["deploy.vue"],"names":[],"mappings":";AAOA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"deploy.vue","sourceRoot":"src/views/flow","sourcesContent":["<template>\n  <basic-container>\n    <avue-form ref=\"form\" :option=\"option\" v-model=\"form\" :upload-before=\"uploadBefore\" :upload-after=\"uploadAfter\"/>\n  </basic-container>\n</template>\n\n<script>\n  import {deployUpload} from \"@/api/flow/flow\";\n  import {flowCategory} from \"@/util/flow\";\n\n  export default {\n    data() {\n      return {\n        form: {\n          flowCategory: '',\n          tenantId: '',\n          flowFile: [],\n          file: {},\n        },\n        option: {\n          labelWidth: 120,\n          menuBtn: false,\n          column: [\n            {\n              label: '流程类型',\n              prop: 'flowCategory',\n              type: 'select',\n              dicUrl: `/api/blade-system/dict/dictionary?code=flow`,\n              props: {\n                label: \"dictValue\",\n                value: \"dictKey\"\n              },\n              row: true,\n              span: 12,\n              dataType: \"number\",\n              rules: [\n                {\n                  required: true,\n                  message: '请选择流程类型',\n                  trigger: 'blur'\n                }\n              ]\n            },\n            {\n              label: \"流程模式\",\n              prop: \"flowMode\",\n              type: \"radio\",\n              dicData: [\n                {\n                  label: \"通用流程\",\n                  value: 1\n                },\n                {\n                  label: \"定制流程\",\n                  value: 2\n                }\n              ],\n              value: 1,\n              row: true,\n              span: 12,\n              rules: [\n                {\n                  required: true,\n                  message: '请选择流程模式',\n                  trigger: 'blur'\n                }\n              ],\n            },\n            {\n              label: \"所属租户\",\n              prop: \"tenantId\",\n              type: \"tree\",\n              multiple: true,\n              dicUrl: \"/api/blade-system/tenant/select\",\n              props: {\n                label: \"tenantName\",\n                value: \"tenantId\"\n              },\n              display: false,\n              row: true,\n              span: 12,\n              rules: [\n                {\n                  required: true,\n                  message: '请选择所属租户',\n                  trigger: 'blur'\n                }\n              ],\n            },\n            {\n              label: '附件上传',\n              prop: 'flowFile',\n              type: 'upload',\n              loadText: '附件上传中，请稍等',\n              span: 24,\n              propsHttp: {\n                res: 'data'\n              },\n              tip: '请上传 bpmn20.xml 标准格式文件',\n              action: '/api/blade-flow/manager/check-upload'\n            },\n          ]\n        }\n      }\n    },\n    watch: {\n      'form.flowMode'() {\n        this.$refs.form.option.column.filter(item => {\n          if (item.prop === \"tenantId\") {\n            item.display = this.form.flowMode === 2;\n          }\n        });\n      }\n    },\n    methods: {\n      uploadBefore(file, done) {\n        this.$message.success('部署开始');\n        this.file = file;\n        done()\n      },\n      uploadAfter(res, done, loading) {\n        if (!this.form.flowCategory) {\n          this.$message.warning('清先选择流程类型');\n          loading()\n          return false;\n        }\n        if (this.form.flowMode === 2 && !this.form.tenantId) {\n          this.$message.warning('清先选择对应租户');\n          loading();\n          return false;\n        }\n        if (res.success) {\n          deployUpload(\n            flowCategory(this.form.flowCategory),\n            (this.form.tenantId) ? this.form.tenantId.join(\",\") : \"\",\n            [this.file]\n          ).then(res => {\n            const data = res.data;\n            if (data.success) {\n              done()\n            } else {\n              this.$message.error(data.msg);\n              loading()\n            }\n          })\n        } else {\n          this.$message.warning('请上传 bpmn20.xml 标准格式文件');\n          loading()\n          return false;\n        }\n      },\n    }\n  }\n</script>\n"]}]}